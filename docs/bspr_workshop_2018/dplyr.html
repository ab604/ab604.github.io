<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Science Workshop</title>
  <meta name="description" content="Lessons for the BSPR 2018 Data Science Workshop">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Data Science Workshop" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lessons for the BSPR 2018 Data Science Workshop" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science Workshop" />
  
  <meta name="twitter:description" content="Lessons for the BSPR 2018 Data Science Workshop" />
  

<meta name="author" content="Alistair Bailey">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="import.html">
<link rel="next" href="transform.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#r-rstudio"><i class="fa fa-check"></i><b>1.1</b> What are R and RStudio?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#environments"><i class="fa fa-check"></i><b>1.1.1</b> Environments</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#why-learn-r-or-any-language"><i class="fa fa-check"></i><b>1.2</b> Why learn R, or any language ?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#finding-your-way-around-rstudio"><i class="fa fa-check"></i><b>1.3</b> Finding your way around RStudio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#what-is-real"><i class="fa fa-check"></i><b>1.3.1</b> What is real?</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#where-am-i"><i class="fa fa-check"></i><b>1.4</b> Where am I?</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#r-projects"><i class="fa fa-check"></i><b>1.5</b> R projects</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#names"><i class="fa fa-check"></i><b>1.6</b> Naming things</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#seeking-help"><i class="fa fa-check"></i><b>1.7</b> Seeking help</a><ul>
<li class="chapter" data-level="1.7.1" data-path="intro.html"><a href="intro.html#asking-for-help"><i class="fa fa-check"></i><b>1.7.1</b> Asking for help</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>2</b> Getting started in R and the tidyverse</a><ul>
<li class="chapter" data-level="2.1" data-path="tidyverse.html"><a href="tidyverse.html#the-tidyverse-and-tidy-data"><i class="fa fa-check"></i><b>2.1</b> The tidyverse and tidy data</a></li>
<li class="chapter" data-level="2.2" data-path="tidyverse.html"><a href="tidyverse.html#data-visualisation"><i class="fa fa-check"></i><b>2.2</b> Data visualisation</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tidyverse.html"><a href="tidyverse.html#viz"><i class="fa fa-check"></i><b>2.2.1</b> Visualisations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="tidyverse.html"><a href="tidyverse.html#workflow-basics"><i class="fa fa-check"></i><b>2.3</b> Workflow basics</a><ul>
<li class="chapter" data-level="2.3.1" data-path="tidyverse.html"><a href="tidyverse.html#assigning-objects"><i class="fa fa-check"></i><b>2.3.1</b> Assigning objects</a></li>
<li class="chapter" data-level="2.3.2" data-path="tidyverse.html"><a href="tidyverse.html#function-anatomy"><i class="fa fa-check"></i><b>2.3.2</b> Function anatomy</a></li>
<li class="chapter" data-level="2.3.3" data-path="tidyverse.html"><a href="tidyverse.html#atomics"><i class="fa fa-check"></i><b>2.3.3</b> Atomic vectors</a></li>
<li class="chapter" data-level="2.3.4" data-path="tidyverse.html"><a href="tidyverse.html#attributes"><i class="fa fa-check"></i><b>2.3.4</b> Attributes</a></li>
<li class="chapter" data-level="2.3.5" data-path="tidyverse.html"><a href="tidyverse.html#factors"><i class="fa fa-check"></i><b>2.3.5</b> Factors</a></li>
<li class="chapter" data-level="2.3.6" data-path="tidyverse.html"><a href="tidyverse.html#lists"><i class="fa fa-check"></i><b>2.3.6</b> Lists</a></li>
<li class="chapter" data-level="2.3.7" data-path="tidyverse.html"><a href="tidyverse.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.3.7</b> Matrices and arrays</a></li>
<li class="chapter" data-level="2.3.8" data-path="tidyverse.html"><a href="tidyverse.html#data-frames"><i class="fa fa-check"></i><b>2.3.8</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tidyverse.html"><a href="tidyverse.html#learning-more-r"><i class="fa fa-check"></i><b>2.4</b> Learning more R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>3</b> Creating scripts and importing data</a><ul>
<li class="chapter" data-level="3.1" data-path="import.html"><a href="import.html#some-definitions"><i class="fa fa-check"></i><b>3.1</b> Some definitions</a><ul>
<li class="chapter" data-level="3.1.1" data-path="import.html"><a href="import.html#file-formats"><i class="fa fa-check"></i><b>3.1.1</b> Rectangular data and flat formats</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="import.html"><a href="import.html#using-scripts"><i class="fa fa-check"></i><b>3.2</b> Using scripts</a></li>
<li class="chapter" data-level="3.3" data-path="import.html"><a href="import.html#running-code"><i class="fa fa-check"></i><b>3.3</b> Running code</a></li>
<li class="chapter" data-level="3.4" data-path="import.html"><a href="import.html#creating-a-r-script"><i class="fa fa-check"></i><b>3.4</b> Creating a R script</a></li>
<li class="chapter" data-level="3.5" data-path="import.html"><a href="import.html#setting-up-our-environment"><i class="fa fa-check"></i><b>3.5</b> Setting up our environment</a><ul>
<li class="chapter" data-level="3.5.1" data-path="import.html"><a href="import.html#biocondutor"><i class="fa fa-check"></i><b>3.5.1</b> Bioconductor</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="import.html"><a href="import.html#importing-data"><i class="fa fa-check"></i><b>3.6</b> Importing data</a></li>
<li class="chapter" data-level="3.7" data-path="import.html"><a href="import.html#exploring-the-data"><i class="fa fa-check"></i><b>3.7</b> Exploring the data</a><ul>
<li class="chapter" data-level="3.7.1" data-path="import.html"><a href="import.html#glimpse-head-and-str"><i class="fa fa-check"></i><b>3.7.1</b> <code>glimpse</code>, <code>head</code> and <code>str</code></a></li>
<li class="chapter" data-level="3.7.2" data-path="import.html"><a href="import.html#summary-statisitics"><i class="fa fa-check"></i><b>3.7.2</b> Summary statisitics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>4</b> <code>dplyr</code> verbs and piping</a><ul>
<li class="chapter" data-level="4.1" data-path="dplyr.html"><a href="dplyr.html#pipes"><i class="fa fa-check"></i><b>4.1</b> Pipes</a></li>
<li class="chapter" data-level="4.2" data-path="dplyr.html"><a href="dplyr.html#filter"><i class="fa fa-check"></i><b>4.2</b> Filter rows</a></li>
<li class="chapter" data-level="4.3" data-path="dplyr.html"><a href="dplyr.html#arrange-rows"><i class="fa fa-check"></i><b>4.3</b> Arrange rows</a></li>
<li class="chapter" data-level="4.4" data-path="dplyr.html"><a href="dplyr.html#select-columns"><i class="fa fa-check"></i><b>4.4</b> Select columns</a></li>
<li class="chapter" data-level="4.5" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>4.5</b> Create new variables</a></li>
<li class="chapter" data-level="4.6" data-path="dplyr.html"><a href="dplyr.html#create-grouped-summaries"><i class="fa fa-check"></i><b>4.6</b> Create grouped summaries</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>5</b> Transforming and visualising proteomics data</a><ul>
<li class="chapter" data-level="5.1" data-path="transform.html"><a href="transform.html#fold-change-and-log-fold-change"><i class="fa fa-check"></i><b>5.1</b> Fold change and log-fold change</a></li>
<li class="chapter" data-level="5.2" data-path="transform.html"><a href="transform.html#missing-values"><i class="fa fa-check"></i><b>5.2</b> Dealing with missing values</a></li>
<li class="chapter" data-level="5.3" data-path="transform.html"><a href="transform.html#normalisation"><i class="fa fa-check"></i><b>5.3</b> Data normalization</a></li>
<li class="chapter" data-level="5.4" data-path="transform.html"><a href="transform.html#hypothesis-testing-with-the-t-test"><i class="fa fa-check"></i><b>5.4</b> Hypothesis testing with the t-test</a></li>
<li class="chapter" data-level="5.5" data-path="transform.html"><a href="transform.html#calculating-fold-change"><i class="fa fa-check"></i><b>5.5</b> Calculating fold change</a></li>
<li class="chapter" data-level="5.6" data-path="transform.html"><a href="transform.html#visualising-the-transformed-data"><i class="fa fa-check"></i><b>5.6</b> Visualising the transformed data</a></li>
<li class="chapter" data-level="5.7" data-path="transform.html"><a href="transform.html#volcano-plot"><i class="fa fa-check"></i><b>5.7</b> Volcano plot</a><ul>
<li class="chapter" data-level="5.7.1" data-path="transform.html"><a href="transform.html#but-which-proteins-are-the-significant-observations"><i class="fa fa-check"></i><b>5.7.1</b> But which proteins are the significant observations?</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="transform.html"><a href="transform.html#creating-a-heatmap"><i class="fa fa-check"></i><b>5.8</b> Creating a heatmap</a><ul>
<li class="chapter" data-level="5.8.1" data-path="transform.html"><a href="transform.html#calculating-similarity-and-clustering"><i class="fa fa-check"></i><b>5.8.1</b> Calculating similarity and clustering</a></li>
<li class="chapter" data-level="5.8.2" data-path="transform.html"><a href="transform.html#plotting-the-heatmap"><i class="fa fa-check"></i><b>5.8.2</b> Plotting the heatmap</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="transform.html"><a href="transform.html#venn"><i class="fa fa-check"></i><b>5.9</b> Venn diagram</a></li>
<li class="chapter" data-level="5.10" data-path="transform.html"><a href="transform.html#peptide-sequence-logos"><i class="fa fa-check"></i><b>5.10</b> Peptide sequence logos</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="going-further.html"><a href="going-further.html"><i class="fa fa-check"></i><b>6</b> Going further</a><ul>
<li class="chapter" data-level="6.1" data-path="going-further.html"><a href="going-further.html#export-figs"><i class="fa fa-check"></i><b>6.1</b> Exporting figures</a></li>
<li class="chapter" data-level="6.2" data-path="going-further.html"><a href="going-further.html#exporting-data"><i class="fa fa-check"></i><b>6.2</b> Exporting data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="going-further.html"><a href="going-further.html#writing-to-a-file"><i class="fa fa-check"></i><b>6.2.1</b> Writing to a file</a></li>
<li class="chapter" data-level="6.2.2" data-path="going-further.html"><a href="going-further.html#for-r"><i class="fa fa-check"></i><b>6.2.2</b> For R</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="going-further.html"><a href="going-further.html#joining-the-r-community"><i class="fa fa-check"></i><b>6.3</b> Joining the R community</a></li>
<li class="chapter" data-level="6.4" data-path="going-further.html"><a href="going-further.html#communication-creating-reports-presentations-and-websites"><i class="fa fa-check"></i><b>6.4</b> Communication: creating reports, presentations and websites</a><ul>
<li class="chapter" data-level="6.4.1" data-path="going-further.html"><a href="going-further.html#using-bookdown-to-write-a-thesis-dissertaion"><i class="fa fa-check"></i><b>6.4.1</b> Using bookdown to write a thesis dissertaion</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="going-further.html"><a href="going-further.html#machine-learning"><i class="fa fa-check"></i><b>6.5</b> Machine Learning</a></li>
<li class="chapter" data-level="6.6" data-path="going-further.html"><a href="going-further.html#version-control"><i class="fa fa-check"></i><b>6.6</b> Version control</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dplyr" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> <code>dplyr</code> verbs and piping</h1>
<p>A core package in the tidyverse is <code>dplyr</code> for transforming data, which is often used in conjunction with the <code>magrittr</code> package that allows us to pipe multiple operations together.</p>
<p>The R4DS dplyr chapter is <a href="http://r4ds.had.co.nz/transform.html">here</a> and for magrittr <a href="http://r4ds.had.co.nz/pipes.html">here</a>.</p>
<p>The figures in this chapter we made for use with an ecological dataset on rodent surveys, but the principles they illustrate are generic and show the use of each function with or without the use of a pipe.</p>
<p>From R4DS:</p>
<p>“<em>All <code>dplyr</code> verbs work similarly:</em></p>
<p><em>1. The first argument is a data frame.</em></p>
<p><em>2. The subsequent arguments describe what to do with the data frame, using the variable names (without quotes).</em></p>
<p><em>3. The result is a new data frame.</em></p>
<p><em>Together these properties make it easy to chain together multiple simple steps to achieve a complex result.</em>&quot;</p>
<div id="pipes" class="section level2">
<h2><span class="header-section-number">4.1</span> Pipes</h2>
<p>A pipe in R looks like this <code>%&gt;%</code> and allows us to send the output of one operation into another. This saves time and space, and can make our code easier to read.</p>
<p>For example we can pipe the output of calling the <code>dat</code> object into the <code>glimpse</code> function like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</code></pre></div>
<pre><code>## Observations: 7,702
## Variables: 8
## $ protein_accession   &lt;chr&gt; &quot;VATA_HUMAN_P38606&quot;, &quot;RL35A_HUMAN_P18077&quot;,...
## $ protein_description &lt;chr&gt; &quot;V-type proton ATPase catalytic subunit A ...
## $ control_1           &lt;dbl&gt; 0.8114, 0.3672, 2.9815, 0.1424, 1.0748, 0....
## $ control_2           &lt;dbl&gt; 0.8575, 0.3853, 4.6176, 0.2238, 0.9451, 0....
## $ control_3           &lt;dbl&gt; 1.0381, 0.4091, 2.8709, 0.1281, 0.8032, 0....
## $ treatment_1         &lt;dbl&gt; 0.6448, 0.4109, 7.1670, 0.1643, 0.7884, 0....
## $ treatment_2         &lt;dbl&gt; 0.7190, 0.4634, 2.0052, 0.2466, 0.8798, 1....
## $ treatment_3         &lt;dbl&gt; 0.4805, 0.3561, 0.8995, 0.1268, 0.7631, 0....</code></pre>
<p>This becomes even more useful when we combine pipes with <code>dplyr</code> functions.</p>
</div>
<div id="filter" class="section level2">
<h2><span class="header-section-number">4.2</span> Filter rows</h2>
<p>The <code>filter</code> function enables us to filter the rows of a data frame according to a logical test (one that is <code>TRUE</code> or <code>FALSE</code>). Here it filters rows in the surveys data where the year variable is greater or equal to 1985.</p>
<p><img src="img/dplyr_filter.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Let’s try this with <code>dat</code> to filter the rows for proteins in <code>control_1</code> and <code>control_2</code> experiments where the observations are greater than 20:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(control_<span class="dv">1</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, control_<span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 8
##   protein_accession   protein_description    control_1 control_2 control_3
##   &lt;chr&gt;               &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 MYH9_HUMAN_P35579   Myosin-9 OS=Homo sapi~      29.2      31.7      24.6
## 2 A0A087WWY3_HUMAN_A~ Filamin-A OS=Homo sap~      31.9      27.8      31.3
## # ... with 3 more variables: treatment_1 &lt;dbl&gt;, treatment_2 &lt;dbl&gt;,
## #   treatment_3 &lt;dbl&gt;</code></pre>
<p>Filtering is done with the following operators <code>&gt;</code>,<code>&lt;</code>,<code>&gt;=</code>,<code>&lt;=</code>,<code>!=</code> (not equal) and <code>==</code> for equal. Not the double equal sign.</p>
</div>
<div id="arrange-rows" class="section level2">
<h2><span class="header-section-number">4.3</span> Arrange rows</h2>
<p>Arranging is similar to filter except that it changes the row order according to the columns in ascending order. If you provide more than one column name, each additional column will be used to break ties in the values of preceding columns.</p>
<p>Here we arrange the surveys data according to the record identification number.</p>
<p><img src="img/dplyr_arrange.png" width="80%" style="display: block; margin: auto;" /></p>
<p>To try that with <code>dat</code> let’s arrange the data according to <code>control_1</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(control_<span class="dv">1</span>)</code></pre></div>
<pre><code>## # A tibble: 7,702 x 8
##    protein_accession protein_description     control_1 control_2 control_3
##    &lt;chr&gt;             &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 PAL4G_HUMAN_P0DN~ Peptidyl-prolyl cis-tr~   0.001      0.0177    NA    
##  2 E5RGV5_HUMAN_E5R~ Nucleolysin TIA-1 isof~   0.0011    NA          0.093
##  3 E5RJP4_HUMAN_E5R~ Glutamine--fructose-6-~   0.002     NA         NA    
##  4 I3L3U1_HUMAN_I3L~ Myosin light chain 4 O~   0.00240   NA         NA    
##  5 ENPLL_HUMAN_Q58F~ Putative endoplasmin-l~   0.0026    NA         NA    
##  6 K1C15_HUMAN_P190~ Keratin_ type I cytosk~   0.00290    0.0615     0.122
##  7 B5ME44_HUMAN_B5M~ Outer dense fiber prot~   0.00290   NA         NA    
##  8 PANK3_HUMAN_Q9H9~ Pantothenate kinase 3 ~   0.0033    NA         NA    
##  9 RRS1_HUMAN_Q15050 Ribosome biogenesis re~   0.0035    NA         NA    
## 10 NFL_HUMAN_P07196  Neurofilament light po~   0.0035     0.315      0.564
## # ... with 7,692 more rows, and 3 more variables: treatment_1 &lt;dbl&gt;,
## #   treatment_2 &lt;dbl&gt;, treatment_3 &lt;dbl&gt;</code></pre>
</div>
<div id="select-columns" class="section level2">
<h2><span class="header-section-number">4.4</span> Select columns</h2>
<p>Selecting is the verb we use to select columns of interest in the data. Here we select only the <code>year</code> and <code>plot_type</code> columns and discard the rest.</p>
<p><img src="img/dplyr_select.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Let’s use select with <code>dat</code> to drop the protein description and control experiments using negative indexing and keep everything else:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>protein_description,<span class="op">-</span>(control_<span class="dv">1</span><span class="op">:</span>control_<span class="dv">3</span>))</code></pre></div>
<pre><code>## # A tibble: 7,702 x 4
##    protein_accession  treatment_1 treatment_2 treatment_3
##    &lt;chr&gt;                    &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 VATA_HUMAN_P38606        0.645       0.719       0.480
##  2 RL35A_HUMAN_P18077       0.411       0.463       0.356
##  3 MYH10_HUMAN_P35580       7.17        2.01        0.900
##  4 RHOG_HUMAN_P84095        0.164       0.247       0.127
##  5 PSA1_HUMAN_P25786        0.788       0.880       0.763
##  6 PRDX5_HUMAN_P30044       0.545       1.69        0.821
##  7 ACLY_HUMAN_P53396        4.67        5.01        3.57 
##  8 VDAC2_HUMAN_P45880       1.01        1.04        0.904
##  9 LRC47_HUMAN_Q8N1G4       1.22        1.01        0.593
## 10 CH60_HUMAN_P10809        8.31        8.31        5.73 
## # ... with 7,692 more rows</code></pre>
</div>
<div id="mutate" class="section level2">
<h2><span class="header-section-number">4.5</span> Create new variables</h2>
<p>Creating new variables uses the <code>mutate</code> verb. Here I am creating a new variable called <code>rodent_type</code> that will create a new column containing the type of rodent observed in each row.</p>
<p><img src="img/dplyr_mutate.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Let’s create a new variable for <code>dat</code> called <code>prot_id</code> that use the <code>str_extract</code> function from the <code>stringr</code> package to take the last 6 characters of the <code>protein_accession</code> variable, the <code>&quot;.{6}$&quot;</code> part is called a regular expression, to keep just the UNIPROT id part of the string.</p>
<p>We’ll use select to drop the other variables except the protein accession afterwards via another pipe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prot_id =</span> <span class="kw">str_extract</span>(protein_accession,<span class="st">&quot;.{6}$&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(protein_accession, prot_id)</code></pre></div>
<pre><code>## # A tibble: 7,702 x 2
##    protein_accession  prot_id
##    &lt;chr&gt;              &lt;chr&gt;  
##  1 VATA_HUMAN_P38606  P38606 
##  2 RL35A_HUMAN_P18077 P18077 
##  3 MYH10_HUMAN_P35580 P35580 
##  4 RHOG_HUMAN_P84095  P84095 
##  5 PSA1_HUMAN_P25786  P25786 
##  6 PRDX5_HUMAN_P30044 P30044 
##  7 ACLY_HUMAN_P53396  P53396 
##  8 VDAC2_HUMAN_P45880 P45880 
##  9 LRC47_HUMAN_Q8N1G4 Q8N1G4 
## 10 CH60_HUMAN_P10809  P10809 
## # ... with 7,692 more rows</code></pre>
</div>
<div id="create-grouped-summaries" class="section level2">
<h2><span class="header-section-number">4.6</span> Create grouped summaries</h2>
<p>The last key verb is <code>summarise</code> which collapses a data frame into a single row.</p>
<p>For example, we could use it to find the average weight of all the animals surveyed in the surveys data using <code>mean()</code>. (Here the <code>na.rm = TRUE</code> argument is given to remove missing values from the data, otherwise R would return <code>NA</code> when trying to average.)</p>
<p><img src="img/dplyr_summarise.png" width="80%" style="display: block; margin: auto;" /></p>
<p><code>summarise</code> is most useful when paired with <code>group_by</code> which defines the variables upon which we operate upon.</p>
<p>Here if we group by <code>species_id</code> and <code>rodent_type</code> together and then used <code>summarise</code> without any arguments we return these two variables only.</p>
<p><img src="img/dplyr_group_by.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We’ll use the <code>mpg</code> dataset again to illustrate a grouped summary. Here I’ll group according fuel type <code>fl</code>, c = compressed natural gas ,d = diesel, e = ethanol, p = premium and r = regular. Then using summarise to calculate the mean highway (<code>hwy</code>) miles per gallon, and the mean urban (<code>cty</code>) miles per gallon,the tables is collapsed from 234 to five rows, one for each fuel type and two columns for the mean mpg;s. This illustrates how grouped summaries provide a very concise way of exploring data as we can immediately see the relative fuel efficiences of each fuel type under two conditions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fl is fuel type. c = compressed natural gas ,d = diesel, </span>
<span class="co"># e = ethanol, p = premium and r = regular.</span>
mpg <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(fl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Create summaries mean_hwy and mean_cty using the mean function, </span>
<span class="st">  </span><span class="co"># dropping any missing variables.</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_hwy =</span> <span class="kw">mean</span>(hwy, <span class="dt">na.rm =</span> T), <span class="dt">mean_cty =</span> <span class="kw">mean</span>(cty, <span class="dt">na.rm =</span> T))</code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   fl    mean_hwy mean_cty
##   &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 c         36      24   
## 2 d         33.6    25.6 
## 3 e         13.2     9.75
## 4 p         25.2    17.4 
## 5 r         23.0    16.7</code></pre>
<p>We’ll use <code>dplyr</code> and pipes in Chapter <a href="transform.html#transform">5</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="import.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transform.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["bspr-workshop-2018.pdf", "bspr-workshop-2018.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
